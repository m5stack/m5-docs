# Module USB {docsify-ignore-all}

<img src="assets/img/product_pics/module/module_usb_01.png" width="30%" height="30%"> <img src="assets/img/product_pics/module/module_usb_02.png" width="30%" height="30%">

***

:memo:**[æè¿°](#æè¿°)**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:octocat:**[ä¾‹ç¨‹](#ä¾‹ç¨‹)**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:electric_plug:**[åŸç†å›¾](#åŸç†å›¾)**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ğŸ›’**[è´­ä¹°é“¾æ¥](https://item.taobao.com/item.htm?spm=a1z10.3-c.w4002-1172588106.13.1dbd425eDUpt0Z&id=583599151180)**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:clapper:**[ç›¸å…³è§†é¢‘](#ç›¸å…³è§†é¢‘)**

## æè¿°

**USB** æ˜¯M5Stackå †å æ¨¡å—ç³»åˆ—ä¸­çš„ä¸€æ¬¾ï¼ŒUSBé©±åŠ¨æ¨¡å—.é›†æˆäº†**MAX3421E**èŠ¯ç‰‡ï¼Œèƒ½å¤Ÿä¸ºä»»ä½•å¸¦æœ‰SPIçš„ç³»ç»Ÿæ·»åŠ USBä¸»æœºæˆ–æ˜¯å¤–è®¾åŠŸèƒ½æ¥å£.å¦‚æœä½ æƒ³ä¸ºä½ çš„è®¾å¤‡æ·»åŠ æ ‡å‡†çš„USBæ¥å£,è¿™æ¬¾USBæ¨¡å—ä¼šå®Œç¾çš„è§£å†³æ–¹æ¡ˆ.

é€šè®¯åè®®: SPI

## äº§å“ç‰¹æ€§

-  1x UAB æ ‡å‡†ç«¯å£ A
-  10x GPIO å¼•è„šæ‹“å±•
-  æ‹“å±• 3v3, 5v & GND

## åŒ…å«

-  1x M5Stack USB æ¨¡å—

## åº”ç”¨

-  USB é”®ç›˜è®°å½•
-  M5Core Uç›˜è¯»å†™å™¨

## ç›¸å…³é“¾æ¥

- **[å®˜æ–¹é¢‘é“è§†é¢‘](https://i.youku.com/i/UNjE1ODA2MzE0OA==?spm=a2hzp.8253869.0.0)**

- **[å®˜æ–¹è®ºå›](http://forum.m5stack.com/)**

- **æ•°æ®æ‰‹å†Œ** - [MAX3421E](https://www.sparkfun.com/datasheets/DevTools/Arduino/MAX3421E.pdf)

## ä¾‹ç¨‹

### Mini Burner

>1.Mini Burneræ˜¯ä¸€ä¸ªç®€æ´å¿«é€Ÿçš„ç¨‹åºçƒ§å½•å™¨ï¼Œæ¯ä¸€ä¸ªäº§å“é¡µé¢é‡Œçš„Mini Burneréƒ½æä¾›äº†ä¸€ä¸ªä¸äº§å“ç›¸å…³çš„æ¡ˆä¾‹ç¨‹åº.
[ç‚¹å‡»æ­¤å¤„ä¸‹è½½](https://m5stack.oss-cn-shenzhen.aliyuncs.com/MiniBurner/Module/MiniBurner_USB_Mouse.exe)

>2.ä¸‹è½½è½¯ä»¶åï¼ŒåŒå‡»è¿è¡Œåº”ç”¨ç¨‹åºï¼Œå°†M5è®¾å¤‡é€šè¿‡æ•°æ®çº¿è¿æ¥è‡³ç”µè„‘,é€‰æ‹©ç«¯å£å‚æ•°ï¼Œç‚¹å‡» **"Burn"** å³å¯å¼€å§‹çƒ§å½•

!>3.Mini Burnerçƒ§å½•å‰éœ€è¦å®‰è£…æœ‰CP210Xï¼ˆUSBé©±åŠ¨ç¨‹åºï¼‰ï¼Œ[ç‚¹å‡»æ­¤å¤„æŸ¥çœ‹é©±åŠ¨å®‰è£…æ•™ç¨‹](zh_CN/related_documents/M5Burner#å®‰è£…ä¸²å£é©±åŠ¨)

*ä»¥ä¸‹ä»£ç ä»…ä¸ºç‰‡æ®µï¼Œå¦‚éœ€è·å–å®Œæ•´ä»£ç ï¼Œ [è¯·ç‚¹å‡»æ­¤å¤„.](https://github.com/m5stack/M5-ProductExampleCodes/tree/master/Module/USB/Arduino).*

**æ³¨æ„:**
åœ¨ç¼–è¯‘è¯¥ç¨‹åºå‰ï¼Œä½ éœ€è¦[ç‚¹å‡»æ­¤å¤„ä¸‹è½½ç›¸åº”çš„USBåº“](https://github.com/m5stack/M5-ProductExampleCodes/tree/master/Module/USB/Arduino/Library).
å¹¶å°†å…¶è§£å‹ç¼©åˆ°Arduinoåº“è·¯å¾„ä¸­.(`C:\Users\<user_name>\Documents\Arduino\libraries`)

<img src="assets/img/product_pics/module/module_usb_03.png">

<img src="assets/img/product_pics/module/module_usb_04.png">

ä¸‹è½½æ¼”ç¤ºç¨‹åº `usb_mouse.ino`
å°†é¼ æ ‡æ¥å…¥ USB æ¨¡å—çš„ A ç«¯å£.

* æŒ‰ä½å·¦æŒ‰é”®æ‹–åŠ¨ç»˜åˆ¶ç™½çº¿.

* æŒ‰ä½å³æŒ‰é”®æ‹–åŠ¨ç»˜åˆ¶ç»¿çº¿.

* æŒ‰ä¸­é—´æ»šè½®æŒ‰é’®æ¸…é™¤å±å¹•.

```arduino
#include <M5Stack.h>
#include <SPI.h>
#include <Usb.h>
#include <hiduniversal.h>
#include <hidboot.h>
#include <usbhub.h>
#include "M5Mouse.h"

// new objects
USB Usb;
USBHub  Hub(&Usb);
HIDBoot<USB_HID_PROTOCOL_MOUSE> HidMouse(&Usb);
MouseRptParser  Prs;

// initialization
M5.begin();
Usb.Init();
HidMouse.SetReportParser(0,(HIDReportParser*)&Prs);

// handle event coming from usb device
Usb.Task();
if(Usb.getUsbTaskState() == USB_STATE_RUNNING)
{
  Mouse_Pointer(mou_px, mou_py);
  mou_px = 0;
  mou_py = 0;
  /* left button pressed: draw white point */
  if (mou_button == 1)
    M5.Lcd.drawCircle(StaPotX, StaPotY, 1, WHITE);
  /* right button pressed: draw green point */
  if (mou_button == 2)
    M5.Lcd.drawCircle(StaPotX, StaPotY, 1, GREEN);
  /* middle button pressed: clear screen */
  if (mou_button == 4)
    M5.Lcd.fillScreen(BLACK);
}
```

<img src="assets/img/product_pics/module/module_example/USB/example_module_usb_01.png">

## åŸç†å›¾

<img src="assets/img/product_pics/module/usb_sch.png">

## ç›¸å…³è§†é¢‘

**USB çš„æ¡ˆä¾‹ - è¯»å– USB è®¾å¤‡**

<video width="500" height="315" controls>
    <source src="https://m5stack.oss-cn-shenzhen.aliyuncs.com/video/Blog/Twitch201902/USB%20Interface.mp4" type="video/mp4">
</video>
