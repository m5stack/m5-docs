# LidarBOT {docsify-ignore-all}

<img src="assets/img/product_pics/app/lidarbot_01.jpg" width="250" height="250"> <img src="assets/img/product_pics/app/lidarbot_03.jpg" width="250" height="250">

* * *

:memo:**[æ¦‚è¦](#æ¦‚è¦)**&nbsp;&nbsp;&nbsp;:octocat:**[ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰](#ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰)**&nbsp;&nbsp;&nbsp;ğŸ›’**[è³¼å…¥ãƒªãƒ³ã‚¯](https://www.aliexpress.com/store/product/M5Stack-New-Lidar-Bot-Mini-Car-Lidar-8m-6Hz-McNamm-Wheels-NeoPixel-LED-Bar-with-ESP32/3226069_32951134988.html)**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:clapper:**[é–¢é€£å‹•ç”»](#é–¢é€£å‹•ç”»)**

## æ¦‚è¦

**<mark>LidarBOT</mark>** ã¯å®¤å†…ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®å››è¼ªè»Šã§ã™ã€‚ æœ¬ä½“ã«ã¯ãƒ©ã‚¤ãƒ€ãƒ¼ã‚»ãƒ³ã‚µãƒ¼ã€4ã¤ã®ãƒ¡ã‚«ãƒŠãƒ ãƒ›ã‚¤ãƒ¼ãƒ«ã€ATmega328pãƒ™ãƒ¼ã‚¹ã®ãƒœãƒˆãƒ ãƒœãƒ¼ãƒ‰ã€ï¼’ã¤ã®ãƒ•ãƒ«ã‚«ãƒ©ãƒ¼LEDãƒãƒ¼ã€LEGOäº’æ›ãƒ›ãƒ¼ãƒ«ã€ãã—ã¦ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã¨ã—ã¦M5StackãŒè£…å‚™ã•ã‚Œã¦ã„ã¾ã™ã€‚

ESP-NOWã‚’åˆ©ç”¨ã—ãŸãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡ã«ã‚ˆã‚Šã€ãƒªãƒ¢ã‚³ãƒ³ã§LidarBOTã‚’æ“ä½œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚åˆ¶å¾¡ä¿¡å·ã‚’å—ä¿¡ã—ãŸå¾Œã€æŒ‡å®šã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§å„ãƒ›ã‚¤ãƒ¼ãƒ«ã¨RGBãƒãƒ¼ã‚’åˆ¶å¾¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã¾ãŸãƒªãƒ¢ã‚³ãƒ³ã«ã‚ˆã‚‹å‰å¾Œå·¦å³ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã ã‘ã§ãªãã€æ­è¼‰ã•ã‚Œã¦ã„ã‚‹M5Coreã®ãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã«ã€ãƒ©ã‚¤ãƒ€ãƒ¼ã‚»ãƒ³ã‚µãƒ¼ã§èª­ã¿å–ã£ãŸåœ°å½¢ãƒãƒƒãƒ—ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## ç‰¹å¾´

- ãƒ©ã‚¤ãƒ€ãƒ¼æ€§èƒ½: 8m @ 6Hz
- ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚µãƒãƒ¼ãƒˆ
  - Arduino
- LEGO äº’æ›ãƒ›ãƒ¼ãƒ«
- [ãƒ¡ã‚«ãƒŠãƒ ãƒ›ã‚¤ãƒ¼ãƒ«](https://en.wikipedia.org/wiki/Mecanum_wheel)

## ãƒ—ãƒ­ãƒˆã‚³ãƒ« (CarBottomBoard)

*ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼š ãƒ‡ãƒ¼ã‚¿ãƒ˜ãƒƒãƒ€ ( ã‚³ãƒãƒ³ãƒ‰ã‚¿ã‚¤ãƒ— ) + ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚±ãƒƒãƒˆ + ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ«*

|åˆ¶å¾¡å¯¾è±¡        | ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ                            | ä¾‹   | é–¢æ•° |
|:-------------:|:------------------------------------: |:---:|:---:|
|Wheels| 0xAA,SpeedX(-7 ~ 7),SpeedY,SpeedZ,SpeedA,0x55 |0xAA, 5, 5, 5, 5, 0x55(Go ahead, speed: 5)|ControlWheel(5, 5, 5)|
| One RGB| 0xAB,LedIndex,R(0 ~ 254),G,B,0x55| 0xAB, 3, 20, 50, 100, 0x55(3th RGB displays specific color)|setLedColor(3, 20, 50, 100)|
| Front RGB Bar| 0xAC,R(0 ~ 254),G,B,0x55|0xAC, 20, 50, 100, 0x55(Front LED Bar displays specific color)|setFrontLedBar(20, 50, 100)|
| Back RGB Bar| 0xAD,R(0 ~ 254),G,B,0x55|0xAD, 20, 50, 100, 0x55(Back LED Bar displays specific color)|setBackLedBar(20, 50, 100)|
| All RGB| 0xAE,R(0 ~ 254),G,B,0x55|0xAE, 20, 50, 100, 0x55(All LED display specific color)|setLedAll(20, 50, 100)|
| ServoMotor0 | 0xAF,Angle(0 ~ 180),0x55|0xAF, 100, 0x55(Servo 0 turns angle 100 degree)|setServo0Angle(100)|
| ServoMotor1 | 0xB0,Angle(0 ~ 180),0x55|0xB0, 100, 0x55(Servo 1 turns angle 100 degree)|setServo1Angle(100)|

<img src="assets/img/product_pics/app/lidarbot_04.jpg" width=60% height=60%>

## ä»•æ§˜

- LidarBot ã‚µã‚¤ã‚º: 142mm x 117mm x 120mm
- é€šä¿¡ä»•æ§˜
  - M5Core(CarMain) <-> Lidar(<mark>**U1RXD**(GPIO16)</mark> <-> Lidar) Serialè¨­å®š: "230400bps, 8, n, 1"(8 bits data, no parity, 1 stop bit)
  - M5Core(CarMain) <-> CarBottomBoard(<mark>**U2TXD**(GPIO17)</mark> <-> Lidar) Serialè¨­å®š: "115200bps, 8, n, 1"(8 bits data, no parity, 1 stop bit)
- ãƒ”ãƒ³ãƒãƒƒãƒ—
  - ServoMotor0 <-> A0(MEGA328)
  - ServoMotor1 <-> A1(MEGA328)
  - NeoPixelRGB <-> 11(MEGA328)

<img src="assets/img/product_pics/app/lidarbot_05.jpg" width="300" height="300">

## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å†…å®¹

- 1x LidarBot
- 1x ãƒªãƒ¢ã‚³ãƒ³ãƒãƒ³ãƒ‰ãƒ«
- 2x ãƒãƒƒãƒ†ãƒª(1300mAh @ 11.1V)
- 1x å……é›»å™¨
- 1x USB Type-C ã‚±ãƒ¼ãƒ–ãƒ«

<img src="assets/img/product_pics/app/lidarbot_02.jpg" width="300" height="300">

## ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

- å®¤å†…ãƒŠãƒ“
- ç„¡äººè¿·è·¯æ¢æŸ»
- ãƒ«ãƒ¼ãƒˆãƒŠãƒ“
- ç„¡äººãƒ‘ã‚¤ãƒ­ãƒƒãƒˆ

## ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰

*å®Œå…¨ãªã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯[ã“ã¡ã‚‰](https://github.com/m5stack/Applications-LidarBot/tree/master/LidarBot/Example)ã€‚*

**ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ„ãƒªãƒ¼æ§‹é€ **

â”œâ”€LidarBot_CarMain_V1.1 - Main program of LidarBot

â”œâ”€LidarBot_RemoteController_V1.0 - Program of RemoteController V1.0

â””â”€LidarBot_RemoteController_V1.2 - Program of RemoteController V1.2(higher precision)

#### ãƒ—ãƒ­ã‚°ãƒ©ãƒ èª¬æ˜:

#### **1. ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚°ãƒ©ãƒ :**

```arduino
/* Main program */
void loop()
{
  espnow.BotConnectUpdate();// ESPNOW reconnect
  lidarcar.MapDisplay();// display map
  esp_now_send(espnow.peer_addr, lidarcar.mapdata, 180);// ESPNOW sends map data
}
```

* **å€‹åˆ¥æ©Ÿèƒ½è§£èª¬:**

  * ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒ‡ãƒ¼ã‚¿èª­ã¿å–ã‚Š

    ```arduino
    #include "lidarcar.h"
    LidarCar lidarcar;

    lidarcar.Init();
    GetData();//save radar data to array distance[]
    ```

  * ãƒ©ã‚¤ãƒ³ãƒˆãƒ¬ãƒ¼ã‚¹

    ```arduino
    #include "rprtrack.h"
    Rprtrack rprtrack;

    SensorStatus();// save line following data to array sensorValue[]
    CalTrackDev();// handle array sensorValue[], get car offset and save it
    ```

  * ESP_NOW

    Please refer to https://github.com/m5stack/M5-espnow


#### **2. é éš”æ“ä½œãƒ—ãƒ­ã‚°ãƒ©ãƒ **

```arduino
/* Main program */
void loop()
{
  espnow.RemoteConnectUpdate();// ESPNOW reconnect
  keyboard.GetValue();// read data of joystick
  // ESPNOW sends joystick data to car
  esp_now_send(espnow.peer_addr, keyboard.keyData, 3);
  MapDisplay();// display map
  accessport.AnalzyCommand();// send map data to PC software
}
```

* **å€‹åˆ¥æ©Ÿèƒ½è§£èª¬:**

  * ã‚¸ãƒ§ã‚¤ã‚¹ãƒ†ã‚£ãƒƒã‚¯

    ```arduino
    #include "keyboard.h"
    KeyBoard keyboard;

    keyboard.Init();
    // get joystick data and save to adX, adY
    GetValue();
    ```

  * PCã¨ã®é€šä¿¡

    ```arduino
    #include "accessport.h"
    AccessPort accessport;

    accessport.AnalzyCommand();// send map data to PC software
    ```

## é–¢é€£å‹•ç”»

**LidarBOT ãƒ‡ãƒ¢**

<video width="500" height="315" controls>
    <source src="https://m5stack.oss-cn-shenzhen.aliyuncs.com/video/Blog/Twitch201904/LidarBot.mp4" type="video/mp4">
</video>